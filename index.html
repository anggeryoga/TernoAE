<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnterYuk - Layanan Antar Jemput</title>
    <meta name="google-site-verification" content="google5194e911c1838310.html" />
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PHZS9DXN');</script>
    <!-- End Google Tag Manager -->
    <meta name="title" content="Terno AE - Jasa Layanan Pengiriman Jepara - Kudus">
    <meta name="description"
        content="Layanan antar jemput terpercaya untuk area Jepara - Kudus. Harga terjangkau dengan diskon 20% dan pelayanan cepat.">
    <meta name="google-site-verification" content="ODVSQjyBAl8fpChDmm4OxQXCmT6zfseXgoy4" />

    <link rel="canonical" href="https://ternoae.web.id" />
    <link rel="icon" href="img/favicon.png" type="image/png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ternoae.web.id">
    <meta property="og:title" content="Terno AE - Jasa Layanan Pengiriman Jepara - Kudus">
    <meta property="og:description"
        content="Layanan antar jemput terpercaya untuk area Jepara - Kudus. Harga terjangkau dengan diskon 20% dan pelayanan cepat.">
    <meta property="og:image" content="img/tumbnile.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DeliveryService",
        "name": "Terno AE",
        "description": "Layanan antar jemput terpercaya untuk area Jepara - Kudus",
        "areaServed": ["Jepara", "Kudus"],
        "offers": {
            "@type": "Offer",
            "description": "Harga terjangkau dengan diskon 20%"
        },
        "url": "https://ternoae.web.id"
    }
    </script>

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<style>
    /* Base Styles */
    :root {
        --whatsapp-green: #25D366;
        --whatsapp-dark-green: #1da851;
        --popup-width-mobile: 300px;
        --popup-width-desktop: 400px;
        --floating-btn-size-mobile: 60px;
        --floating-btn-size-desktop: 70px;
    }

    /* WhatsApp Popup */
    .whatsapp-popup {
        position: fixed;
        bottom: -100%;
        right: 20px;
        width: var(--popup-width-mobile);
        background: #fff;
        border-radius: 15px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s ease-in-out;
    }

    .whatsapp-popup.show {
        bottom: calc(var(--floating-btn-size-mobile) + 30px);
        opacity: 1;
        visibility: visible;
    }

    /* Close Button */
    .whatsapp-close {
        position: absolute;
        top: -15px;
        right: -15px;
        width: 30px;
        height: 30px;
        background: #e74c3c;
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background 0.3s;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .whatsapp-close:hover {
        background: #c0392b;
    }

    /* Header */
    .whatsapp-header {
        background: var(--whatsapp-green);
        color: white;
        padding: 20px;
        border-radius: 15px 15px 0 0;
        display: flex;
        align-items: center;
        gap: 15px;
    }

    .whatsapp-header i {
        font-size: 28px;
    }

    .whatsapp-header h3 {
        margin: 0;
        font-size: 20px;
        font-weight: 600;
    }

    /* Message */
    .whatsapp-message {
        padding: 25px;
        color: #333;
        font-size: 16px;
        line-height: 1.6;
    }

    /* Buttons Container */
    .whatsapp-buttons {
        padding: 0 25px 25px;
        display: flex;
        gap: 15px;
    }

    /* Button Styles */
    .whatsapp-btn {
        flex: 1;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 500;
        transition: all 0.3s;
    }

    .whatsapp-btn.primary {
        background: var(--whatsapp-green);
        color: white;
    }

    .whatsapp-btn.primary:hover {
        background: var(--whatsapp-dark-green);
        transform: translateY(-2px);
    }

    .whatsapp-btn.secondary {
        background: #f1f3f5;
        color: #495057;
    }

    .whatsapp-btn.secondary:hover {
        background: #e9ecef;
        transform: translateY(-2px);
    }

    /* Floating Button */
    .floating-whatsapp {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: var(--floating-btn-size-mobile);
        height: var(--floating-btn-size-mobile);
        background: var(--whatsapp-green);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 32px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        transition: all 0.3s;
        z-index: 9998;
    }

    .floating-whatsapp:hover {
        transform: scale(1.1) translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    .floating-whatsapp i {
        animation: bounce 2s infinite;
    }

    @keyframes bounce {

        0%,
        100% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-10px);
        }
    }

    /* Desktop Styles */
    @media screen and (min-width: 1024px) {
        .whatsapp-popup {
            width: var(--popup-width-desktop);
            right: 30px;
        }

        .whatsapp-popup.show {
            bottom: calc(var(--floating-btn-size-desktop) + 40px);
        }

        .floating-whatsapp {
            width: var(--floating-btn-size-desktop);
            height: var(--floating-btn-size-desktop);
            right: 30px;
            bottom: 30px;
            font-size: 38px;
        }

        .whatsapp-header {
            padding: 25px;
        }

        .whatsapp-header i {
            font-size: 32px;
        }

        .whatsapp-header h3 {
            font-size: 22px;
        }

        .whatsapp-message {
            padding: 30px;
            font-size: 18px;
        }

        .whatsapp-buttons {
            padding: 0 30px 30px;
        }

        .whatsapp-btn {
            padding: 15px 25px;
            font-size: 18px;
        }
    }
</style>

<body>
    <div class="container">
        <div class="app-container">
            <div class="header">
                <h1>Terno AE</h1>
                <p>Jasa Layanan Pengiriman Jepara - Kudus</p>
            </div>

            <div id="map"></div>

            <div class="controls">
                <div class="pickup-options">
                    <button class="option-btn active" onclick="showGPSOption()">
                        <i class="fas fa-map-marker-alt"></i> GPS
                    </button>
                    <button class="option-btn" onclick="showManualOption()">
                        <i class="fas fa-search"></i> Cari Manual
                    </button>
                </div>

                <div id="gps-option">
                    <button class="location-btn" onclick="getPickupLocation()">
                        <i class="fas fa-map-marker-alt"></i>
                        Tentukan Lokasi Jemput dengan GPS
                    </button>
                </div>

                <div id="manual-option" style="display: none;">
                    <div class="search-container">
                        <input type="text" id="pickup-search" class="search-input"
                            placeholder="Cari lokasi jemput (nama desa)" oninput="searchPickupLocation(this.value)">
                        <div id="pickup-search-results" class="search-results"></div>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" id="destination-search" class="search-input"
                        placeholder="Cari lokasi tujuan (nama desa)" oninput="searchLocation(this.value)">
                    <div id="search-results" class="search-results"></div>
                </div>

                <div class="location-display">
                    <div class="coordinate-box">
                        <div>
                            <span>Lokasi Jemput</span><br>
                            <strong id="pickup-coords">Belum ditentukan</strong>
                        </div>
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="coordinate-box">
                        <div>
                            <span>Lokasi Tujuan</span><br>
                            <strong id="destination-coords">Belum ditentukan</strong>
                        </div>
                        <i class="fas fa-flag-checkered"></i>
                    </div>
                </div>

                <div class="result-container" id="result" style="display: none;">
                    <h3>Detail Perjalanan</h3>
                    <div>Jarak: <strong><span id="distance">0</span> km</strong></div>
                    <div id="promo-timer" class="promo-timer" style="display: none;">
                        Promo Berakhir Dalam: <span id="timer">01:00:00</span>
                    </div>
                    <div class="price-display">
                        <div class="original-price">Rp <span id="original-price">0</span></div>
                        <div>Rp <span id="price">0</span> <span class="discount-badge">Diskon 20%</span></div>
                    </div>
                    <button class="contact-btn" onclick="hubungiAdmin()">
                        Hubungi Admin via WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>
    !-- WhatsApp Chat HTML -->
    <div class="whatsapp-popup" id="whatsapp-popup">
        <button class="whatsapp-close" onclick="closeWhatsAppPopup()">×</button>
        <div class="whatsapp-header">
            <i class="fab fa-whatsapp"></i>
            <h3>Hubungi Kami</h3>
        </div>
        <div class="whatsapp-message">
            Apakah Anda ingin menghubungi admin kami melalui WhatsApp?
        </div>
        <div class="whatsapp-buttons">
            <button class="whatsapp-btn primary" onclick="confirmWhatsApp()">Ya, Hubungi</button>
            <button class="whatsapp-btn secondary" onclick="closeWhatsAppPopup()">Nanti Saja</button>
        </div>
    </div>

    <!-- Floating WhatsApp button -->
    <div class="floating-whatsapp" id="floating-whatsapp" onclick="showWhatsAppPopup()">
        <i class="fab fa-whatsapp"></i>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script>
        // Global variables
        let map;
        let markers = {};
        let route = null;
        let destinationDetails = null;
        let promoEndTime;
        let timerInterval;
        let isPopupVisible = false;
        let timer = null;

        // Initialize map
        function initMap() {
            map = L.map('map').setView([-6.588983449484304, 110.66654121864478], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(map);
        }

        // Show GPS option
        function showGPSOption() {
            document.getElementById('gps-option').style.display = 'block';
            document.getElementById('manual-option').style.display = 'none';
            document.querySelectorAll('.option-btn')[0].classList.add('active');
            document.querySelectorAll('.option-btn')[1].classList.remove('active');
        }

        // Show manual option
        function showManualOption() {
            document.getElementById('gps-option').style.display = 'none';
            document.getElementById('manual-option').style.display = 'block';
            document.querySelectorAll('.option-btn')[0].classList.remove('active');
            document.querySelectorAll('.option-btn')[1].classList.add('active');
        }

        // Initialize promo timer
        function initPromoTimer() {
            promoEndTime = new Date().getTime() + (60 * 60 * 1000); // 1 hour
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
            document.getElementById('promo-timer').style.display = 'block';
        }

        // Update timer
        function updateTimer() {
            const now = new Date().getTime();
            const distance = promoEndTime - now;

            if (distance <= 0) {
                clearInterval(timerInterval);
                document.getElementById('promo-timer').style.display = 'none';
                return;
            }

            const hours = Math.floor(distance / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('timer').textContent =
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Search pickup location
        async function searchPickupLocation(query) {
            if (query.length < 3) {
                document.getElementById('pickup-search-results').style.display = 'none';
                return;
            }

            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?q=${query}+indonesia&format=json&limit=5`
                );
                const data = await response.json();

                const resultsContainer = document.getElementById('pickup-search-results');
                resultsContainer.innerHTML = '';
                resultsContainer.style.display = 'block';

                data.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    div.textContent = result.display_name;
                    div.onclick = () => selectPickupLocation(result);
                    resultsContainer.appendChild(div);
                });
            } catch (error) {
                console.error('Error searching:', error);
            }
        }

        // Select pickup location
        function selectPickupLocation(location) {
            const coords = [location.lat, location.lon];

            if (markers['pickup']) {
                map.removeLayer(markers['pickup']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-map-marker-alt" style="color: #00f5d4; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['pickup'] = L.marker(coords, { icon }).addTo(map);
            document.getElementById('pickup-coords').textContent = location.display_name;
            document.getElementById('pickup-search-results').style.display = 'none';
            document.getElementById('pickup-search').value = location.display_name;
            map.setView(coords, 16);

            if (markers['destination']) {
                calculateRoute();
            }
        }

        // Get pickup location via GPS
        function getPickupLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    positionSuccess,
                    positionError,
                    { enableHighAccuracy: true, timeout: 10000 }
                );
            } else {
                positionError();
            }
        }

        // Handle successful GPS position
        function positionSuccess(position) {
            const { latitude, longitude } = position.coords;
            const location = [latitude, longitude];

            if (markers['pickup']) {
                map.removeLayer(markers['pickup']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-map-marker-alt" style="color: #00f5d4; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['pickup'] = L.marker(location, { icon }).addTo(map);
            map.setView(location, 16);

            document.getElementById('pickup-coords').textContent =
                `${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;

            if (markers['destination']) {
                calculateRoute();
            }
        }

        // Handle GPS error
        function positionError(error) {
            if (error && error.code === error.PERMISSION_DENIED) {
                alert("Izin lokasi ditolak. Anda akan diarahkan ke pencarian manual.");
                showManualOption();
            } else {
                let errorMessage = "Terjadi kesalahan dalam mengakses lokasi. Coba gunakan pencarian manual.";
                if (error && error.code === error.TIMEOUT) {
                    errorMessage = "Waktu permintaan lokasi habis. Silakan gunakan pencarian manual.";
                }
                alert(errorMessage);
                showManualOption();
            }
        }

        // Search destination location
        async function searchLocation(query) {
            if (query.length < 3) {
                document.getElementById('search-results').style.display = 'none';
                return;
            }

            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?q=${query}+indonesia&format=json&limit=5`
                );
                const data = await response.json();

                const resultsContainer = document.getElementById('search-results');
                resultsContainer.innerHTML = '';
                resultsContainer.style.display = 'block';

                data.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    div.textContent = result.display_name;
                    div.onclick = () => selectDestination(result);
                    resultsContainer.appendChild(div);
                });
            } catch (error) {
                console.error('Error searching:', error);
            }
        }

        // Select destination
        function selectDestination(location) {
            const coords = [location.lat, location.lon];
            destinationDetails = {
                name: location.display_name,
                coords: coords
            };

            if (markers['destination']) {
                map.removeLayer(markers['destination']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-flag-checkered" style="color: #FFA9A3; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['destination'] = L.marker(coords, { icon }).addTo(map);
            document.getElementById('destination-coords').textContent = location.display_name;
            document.getElementById('search-results').style.display = 'none';
            document.getElementById('destination-search').value = location.display_name;

            if (markers['pickup']) {
                calculateRoute();
            }
        }

        // Calculate route and price
        async function calculateRoute() {
            const pickup = markers['pickup'].getLatLng();
            const destination = markers['destination'].getLatLng();

            if (route) {
                map.removeLayer(route);
            }

            try {
                const response = await fetch(
                    `https://router.project-osrm.org/route/v1/driving/${pickup.lng},${pickup.lat};${destination.lng},${destination.lat}?overview=full&geometries=geojson`
                );
                const data = await response.json();

                if (data.routes && data.routes.length > 0) {
                    route = L.geoJSON(data.routes[0].geometry, {
                        style: {
                            color: '#000',
                            weight: 4,
                            opacity: 0.7
                        }
                    }).addTo(map);

                    const distance = (data.routes[0].distance / 1000).toFixed(2);
                    const basePrice = Math.ceil(distance * 1500);
                    const inflatedPrice = Math.ceil(basePrice * 1.2); // Up 20%
                    const finalPrice = Math.ceil(inflatedPrice * 0.8); // Discount 20%

                    document.getElementById('distance').textContent = distance;
                    document.getElementById('original-price').textContent = inflatedPrice.toLocaleString('id-ID');
                    document.getElementById('price').textContent = finalPrice.toLocaleString('id-ID');
                    document.getElementById('result').style.display = 'block';

                    map.fitBounds(route.getBounds(), { padding: [50, 50] });
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Gagal menghitung rute. Silakan coba lagi.');
            }
        }

        // WhatsApp Chat Functions
        function showWhatsAppPopup() {
            const popup = document.getElementById('whatsapp-popup');
            const floatingBtn = document.getElementById('floating-whatsapp');

            if (!isPopupVisible) {
                floatingBtn.style.transform = 'scale(0.8)';
                setTimeout(() => {
                    floatingBtn.style.transform = 'scale(1)';
                }, 200);

                popup.classList.add('show');
                isPopupVisible = true;
                startAutoHideTimer();

                setTimeout(() => {
                    document.addEventListener('click', handleClickOutside);
                }, 100);
            }
        }

        function closeWhatsAppPopup() {
            const popup = document.getElementById('whatsapp-popup');

            if (isPopupVisible) {
                popup.classList.remove('show');
                isPopupVisible = false;
                document.removeEventListener('click', handleClickOutside);
                if (timer) clearTimeout(timer);
            }
        }

        function handleClickOutside(event) {
            const popup = document.getElementById('whatsapp-popup');
            const floatingBtn = document.getElementById('floating-whatsapp');

            if (isPopupVisible && !popup.contains(event.target) && event.target !== floatingBtn) {
                closeWhatsAppPopup();
            }
        }

        function startAutoHideTimer() {
            if (timer) clearTimeout(timer);
            timer = setTimeout(() => {
                closeWhatsAppPopup();
            }, 10000);
        }

        function resetAutoHideTimer() {
            if (timer) clearTimeout(timer);
            if (isPopupVisible) {
                startAutoHideTimer();
            }
        }

        function confirmWhatsApp() {
            const price = document.getElementById('price').textContent;
            const originalPrice = document.getElementById('original-price').textContent;
            const pickupCoords = document.getElementById('pickup-coords').textContent;
            const destinationCoords = document.getElementById('destination-coords').textContent;

            const message = `kak saya mau anjem (antar jemput) dari ${pickupCoords} ke ${destinationCoords}\nHarga awal: Rp ${originalPrice}\nSetelah diskon 20%: Rp ${price}`;

            window.open(`https://wa.me/6285155145788?text=${encodeURIComponent(message)}`, '_blank');
            closeWhatsAppPopup();
        }

        // Initialize everything on page load
        window.onload = function () {
            initMap();
            initPromoTimer();

            // Initialize WhatsApp features
            const popup = document.getElementById('whatsapp-popup');
            const floatingBtn = document.getElementById('floating-whatsapp');

            if (popup && floatingBtn) {
                popup.addEventListener('mouseenter', resetAutoHideTimer);
                popup.addEventListener('mousemove', resetAutoHideTimer);
                popup.addEventListener('touchstart', resetAutoHideTimer);

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && isPopupVisible) {
                        closeWhatsAppPopup();
                    }
                });

                // Auto show popup after 5 seconds
                setTimeout(() => {
                    showWhatsAppPopup();
                }, 5000);

                // Add periodic animation to floating button
                setInterval(() => {
                    if (!isPopupVisible) {
                        floatingBtn.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            floatingBtn.style.transform = 'scale(1)';
                        }, 200);
                    }
                }, 10000);
            }
        };

        // Handle visibility change
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && isPopupVisible) {
                closeWhatsAppPopup();
            }
        });

        // Handle mobile back button
        window.addEventListener('popstate', function () {
            if (isPopupVisible) {
                closeWhatsAppPopup();
            }
        });
    </script>
</body>

</html>