<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnterYuk - Layanan Antar Jemput</title>
    <meta name="google-site-verification" content="google5194e911c1838310.html" />
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-PHZS9DXN');</script>
    <!-- End Google Tag Manager -->
    <meta name="title" content="Terno AE - Jasa Layanan Pengiriman Jepara - Kudus">
    <meta name="description"
        content="Layanan antar jemput terpercaya untuk area Jepara - Kudus. Harga terjangkau dengan diskon 20% dan pelayanan cepat.">
    <meta name="google-site-verification" content="ODVSQjyBAl8fpChDmm4OxQXCmT6zfseXgoy4" />

    <link rel="canonical" href="https://ternoae.web.id" />
    <link rel="icon" href="img/favicon.png" type="image/png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ternoae.web.id">
    <meta property="og:title" content="Terno AE - Jasa Layanan Pengiriman Jepara - Kudus">
    <meta property="og:description"
        content="Layanan antar jemput terpercaya untuk area Jepara - Kudus. Harga terjangkau dengan diskon 20% dan pelayanan cepat.">
    <meta property="og:image" content="img/tumbnile.png">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "DeliveryService",
        "name": "Terno AE",
        "description": "Layanan antar jemput terpercaya untuk area Jepara - Kudus",
        "areaServed": ["Jepara", "Kudus"],
        "offers": {
            "@type": "Offer",
            "description": "Harga terjangkau dengan diskon 20%"
        },
        "url": "https://ternoae.web.id"
    }
    </script>

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<style>
    .whatsapp-box {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
        width: 300px;
        display: none;
        /* Hide by default */
        z-index: 1000;
    }

    .whatsapp-box.show {
        display: block;
        /* Show when toggle is clicked */
    }

    .whatsapp-header {
        background: #25D366;
        color: white;
        padding: 15px;
        border-radius: 10px 10px 0 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .whatsapp-header h4 {
        margin: 0;
        font-size: 16px;
    }

    .close-btn {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 18px;
    }

    .whatsapp-body {
        padding: 15px;
    }

    .whatsapp-message {
        background: #DCF8C6;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 15px;
        font-size: 14px;
    }

    .whatsapp-input {
        display: flex;
        gap: 10px;
    }

    .whatsapp-input input {
        flex: 1;
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 20px;
        outline: none;
    }

    .whatsapp-input button {
        background: #25D366;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .whatsapp-toggle {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: #25D366;
        color: white;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        z-index: 999;
    }

    .whatsapp-toggle i {
        font-size: 30px;
    }

    @media (max-width: 480px) {
        .whatsapp-box {
            width: calc(100% - 40px);
            bottom: 80px;
        }
    }
</style>

<body>
    <div class="container">
        <div class="app-container">
            <div class="header">
                <h1>Terno AE</h1>
                <p>Jasa Layanan Pengiriman Jepara - Kudus</p>
            </div>

            <div id="map"></div>

            <div class="controls">
                <div class="pickup-options">
                    <button class="option-btn active" onclick="showGPSOption()">
                        <i class="fas fa-map-marker-alt"></i> GPS
                    </button>
                    <button class="option-btn" onclick="showManualOption()">
                        <i class="fas fa-search"></i> Cari Manual
                    </button>
                </div>

                <div id="gps-option">
                    <button class="location-btn" onclick="getPickupLocation()">
                        <i class="fas fa-map-marker-alt"></i>
                        Tentukan Lokasi Jemput dengan GPS
                    </button>
                </div>

                <div id="manual-option" style="display: none;">
                    <div class="search-container">
                        <input type="text" id="pickup-search" class="search-input"
                            placeholder="Cari lokasi jemput (nama desa)" oninput="searchPickupLocation(this.value)">
                        <div id="pickup-search-results" class="search-results"></div>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" id="destination-search" class="search-input"
                        placeholder="Cari lokasi tujuan (nama desa)" oninput="searchLocation(this.value)">
                    <div id="search-results" class="search-results"></div>
                </div>

                <div class="location-display">
                    <div class="coordinate-box">
                        <div>
                            <span>Lokasi Jemput</span><br>
                            <strong id="pickup-coords">Belum ditentukan</strong>
                        </div>
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <div class="coordinate-box">
                        <div>
                            <span>Lokasi Tujuan</span><br>
                            <strong id="destination-coords">Belum ditentukan</strong>
                        </div>
                        <i class="fas fa-flag-checkered"></i>
                    </div>
                </div>

                <div class="result-container" id="result" style="display: none;">
                    <h3>Detail Perjalanan</h3>
                    <div>Jarak: <strong><span id="distance">0</span> km</strong></div>
                    <div id="promo-timer" class="promo-timer" style="display: none;">
                        Promo Berakhir Dalam: <span id="timer">01:00:00</span>
                    </div>
                    <div class="price-display">
                        <div class="original-price">Rp <span id="original-price">0</span></div>
                        <div>Rp <span id="price">0</span> <span class="discount-badge">Diskon 20%</span></div>
                    </div>
                    <button class="contact-btn" onclick="hubungiAdmin()">
                        Hubungi Admin via WhatsApp
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="whatsapp-toggle" onclick="toggleWhatsAppBox()">
        <i class="fab fa-whatsapp"></i>
    </div>

    <!-- WhatsApp Chat Box -->
    <div class="whatsapp-box" id="whatsappBox">
        <div class="whatsapp-header">
            <h4>Customer Service</h4>
            <button class="close-btn" onclick="toggleWhatsAppBox()">Ã—</button>
        </div>
        <div class="whatsapp-body">
            <div class="whatsapp-message">
                Halo! ðŸ‘‹ Silakan tinggalkan pesan, kami akan segera membalas.
            </div>
            <div class="whatsapp-input">
                <input type="text" id="whatsappInput" placeholder="Ketik pesan..." onkeypress="handleKeyPress(event)">
                <button onclick="sendWhatsAppMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script>
        function toggleWhatsAppBox() {
            const box = document.getElementById('whatsappBox');
            box.classList.toggle('show');
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendWhatsAppMessage();
            }
        }

        function sendWhatsAppMessage() {
            const input = document.getElementById('whatsappInput');
            const message = input.value.trim();

            if (message) {
                const whatsappNumber = '6282324159922';
                const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
                window.open(url, '_blank');
                input.value = '';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const welcomeMessage = document.querySelector('.whatsapp-message');
            welcomeMessage.style.opacity = '0';
            setTimeout(() => {
                welcomeMessage.style.opacity = '1';
                welcomeMessage.style.transition = 'opacity 0.5s ease';
            }, 500);
        });
    </script>
    <script>
        // Modify existing hubungiAdmin function
        function hubungiAdmin() {
            const price = document.getElementById('price').textContent;
            const originalPrice = document.getElementById('original-price').textContent;
            const pickupCoords = document.getElementById('pickup-coords').textContent.replace(/\s+/g, '');
            const destinationName = document.getElementById('destination-coords').textContent;

            const message = `kak saya mau anjem (antar jemput) dari https://maps.google.com/?q=${pickupCoords} ke ${destinationName}\nHarga awal: Rp ${originalPrice}\nSetelah diskon 20%: Rp ${price}`;

            window.open(`https://wa.me/6285155145788?text=${encodeURIComponent(message)}`);
        }
        let map;
        let markers = {};
        let route = null;
        let destinationDetails = null;
        let promoEndTime;
        let timerInterval;

        // Inisialisasi peta
        function initMap() {
            map = L.map('map').setView([-6.588983449484304, 110.66654121864478], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Â© OpenStreetMap contributors'
            }).addTo(map);
        }

        function showGPSOption() {
            document.getElementById('gps-option').style.display = 'block';
            document.getElementById('manual-option').style.display = 'none';
            document.querySelectorAll('.option-btn')[0].classList.add('active');
            document.querySelectorAll('.option-btn')[1].classList.remove('active');
        }

        function showManualOption() {
            document.getElementById('gps-option').style.display = 'none';
            document.getElementById('manual-option').style.display = 'block';
            document.querySelectorAll('.option-btn')[0].classList.remove('active');
            document.querySelectorAll('.option-btn')[1].classList.add('active');
        }

        // Inisialisasi waktu promo
        function initPromoTimer() {
            promoEndTime = new Date().getTime() + (60 * 60 * 1000); // 1 jam
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
            document.getElementById('promo-timer').style.display = 'block';
        }

        function updateTimer() {
            const now = new Date().getTime();
            const distance = promoEndTime - now;

            if (distance <= 0) {
                clearInterval(timerInterval);
                document.getElementById('promo-timer').style.display = 'none';
                return;
            }

            const hours = Math.floor(distance / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);

            document.getElementById('timer').textContent =
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        async function searchPickupLocation(query) {
            if (query.length < 3) {
                document.getElementById('pickup-search-results').style.display = 'none';
                return;
            }

            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?q=${query}+indonesia&format=json&limit=5`
                );
                const data = await response.json();

                const resultsContainer = document.getElementById('pickup-search-results');
                resultsContainer.innerHTML = '';
                resultsContainer.style.display = 'block';

                data.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    div.textContent = result.display_name;
                    div.onclick = () => selectPickupLocation(result);
                    resultsContainer.appendChild(div);
                });
            } catch (error) {
                console.error('Error searching:', error);
            }
        }

        function selectPickupLocation(location) {
            const coords = [location.lat, location.lon];

            if (markers['pickup']) {
                map.removeLayer(markers['pickup']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-map-marker-alt" style="color: #00f5d4; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['pickup'] = L.marker(coords, { icon }).addTo(map);
            document.getElementById('pickup-coords').textContent = location.display_name;
            document.getElementById('pickup-search-results').style.display = 'none';
            document.getElementById('pickup-search').value = location.display_name;
            map.setView(coords, 16);


            if (markers['destination']) {
                calculateRoute();
            }
        }

        // Fungsi untuk mendapatkan lokasi jemput
        function getPickupLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    positionSuccess,
                    positionError,
                    { enableHighAccuracy: true, timeout: 10000 }
                );
            } else {
                positionError();
            }
        }

        // Callback sukses GPS
        function positionSuccess(position) {
            const { latitude, longitude } = position.coords;
            const location = [latitude, longitude];

            if (markers['pickup']) {
                map.removeLayer(markers['pickup']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-map-marker-alt" style="color: #00f5d4; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['pickup'] = L.marker(location, { icon }).addTo(map);
            map.setView(location, 16);

            document.getElementById('pickup-coords').textContent =
                `${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;

            if (markers['destination']) {
                calculateRoute();
            }
        }

        // Callback error GPS
        function positionError(error) {
            if (error && error.code === error.PERMISSION_DENIED) {
                alert("Izin lokasi ditolak.  Anda akan diarahkan ke pencarian manual.");
                showManualOption(); // Langsung alihkan ke manual jika izin ditolak.
            } else {
                let errorMessage = "Terjadi kesalahan dalam mengakses lokasi. Coba gunakan pencarian manual.";
                if (error && error.code === error.TIMEOUT) {
                    errorMessage = "Waktu permintaan lokasi habis. Silakan gunakan pencarian manual.";
                }
                alert(errorMessage);
                showManualOption();
            }

        }

        // Fungsi pencarian lokasi
        async function searchLocation(query) {
            if (query.length < 3) {
                document.getElementById('search-results').style.display = 'none';
                return;
            }

            try {
                const response = await fetch(
                    `https://nominatim.openstreetmap.org/search?q=${query}+indonesia&format=json&limit=5`
                );
                const data = await response.json();

                const resultsContainer = document.getElementById('search-results');
                resultsContainer.innerHTML = '';
                resultsContainer.style.display = 'block';

                data.forEach(result => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    div.textContent = `${result.display_name}`;
                    div.onclick = () => selectDestination(result);
                    resultsContainer.appendChild(div);
                });
            } catch (error) {
                console.error('Error searching:', error);
            }
        }

        // Fungsi memilih lokasi tujuan
        function selectDestination(location) {
            const coords = [location.lat, location.lon];
            destinationDetails = {
                name: location.display_name,
                coords: coords
            };

            if (markers['destination']) {
                map.removeLayer(markers['destination']);
            }

            const icon = L.divIcon({
                className: 'custom-div-icon',
                html: '<i class="fas fa-flag-checkered" style="color: #FFA9A3; font-size: 24px;"></i>',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });

            markers['destination'] = L.marker(coords, { icon }).addTo(map);
            document.getElementById('destination-coords').textContent =
                `${location.display_name}`;
            document.getElementById('search-results').style.display = 'none';
            document.getElementById('destination-search').value = location.display_name;

            if (markers['pickup']) {
                calculateRoute();
            }
        }


        // Fungsi untuk menghitung rute dan jarak
        async function calculateRoute() {
            const pickup = markers['pickup'].getLatLng();
            const destination = markers['destination'].getLatLng();

            if (route) {
                map.removeLayer(route);
            }

            try {
                const response = await fetch(
                    `https://router.project-osrm.org/route/v1/driving/${pickup.lng},${pickup.lat};${destination.lng},${destination.lat}?overview=full&geometries=geojson`
                );
                const data = await response.json();

                if (data.routes && data.routes.length > 0) {
                    route = L.geoJSON(data.routes[0].geometry, {
                        style: {
                            color: '#000',
                            weight: 4,
                            opacity: 0.7
                        }
                    }).addTo(map);

                    const distance = (data.routes[0].distance / 1000).toFixed(2);
                    const basePrice = Math.ceil(distance * 1500);
                    const inflatedPrice = Math.ceil(basePrice * 1.2); // Naik 20%
                    const finalPrice = Math.ceil(inflatedPrice * 0.8); // Diskon 20%

                    document.getElementById('distance').textContent = distance;
                    document.getElementById('original-price').textContent = inflatedPrice.toLocaleString('id-ID');
                    document.getElementById('price').textContent = finalPrice.toLocaleString('id-ID');
                    document.getElementById('result').style.display = 'block';

                    map.fitBounds(route.getBounds(), { padding: [50, 50] });
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Gagal menghitung rute. Silakan coba lagi.');
            }
        }
        function toggleWhatsAppBox() {
            const box = document.getElementById('whatsappBox');
            box.classList.toggle('show');
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendWhatsAppMessage();
            }
        }

        function sendWhatsAppMessage() {
            const input = document.getElementById('whatsappInput');
            const message = input.value.trim();

            if (message) {
                const whatsappNumber = '6282324159922';
                const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
                window.open(url, '_blank');
                input.value = '';
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const welcomeMessage = document.querySelector('.whatsapp-message');
            welcomeMessage.style.opacity = '0';
            setTimeout(() => {
                welcomeMessage.style.opacity = '1';
                welcomeMessage.style.transition = 'opacity 0.5s ease';
            }, 500);
        });

        // Fungsi untuk menghubungi admin
        function hubungiAdmin() {
            const price = document.getElementById('price').textContent;
            const originalPrice = document.getElementById('original-price').textContent;
            const pickupCoords = document.getElementById('pickup-coords').textContent.replace(/\s+/g, '');
            const destinationName = document.getElementById('destination-coords').textContent;

            const message = `kak saya mau anjem (antar jemput) dari ${pickupCoords} ke ${destinationName}\nHarga awal: Rp ${originalPrice}\nSetelah diskon 20%: Rp ${price}`;

            window.open(`https://wa.me/6282324159922?text=${encodeURIComponent(message)}`);
        }

        // Inisialisasi saat halaman dimuat
        window.onload = function () {
            initMap();
            initPromoTimer();
        };
    </script>
</body>

</html>